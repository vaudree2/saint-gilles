<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bon Cadeau Premium – Le Vaudrée 2</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Poppins', sans-serif; background: #fdf7f0; color: #222; margin:0; padding:0;}
  main { max-width:900px; margin:50px auto; padding:0 20px; }
  h1 { font-family: 'Playfair Display', serif; color: #d4af37; text-align:center; font-size:2.8rem; margin-bottom:5px;}
  h2 { font-family: 'Playfair Display', serif; color:#b22222; text-align:center; font-size:1.8rem; margin-bottom:30px;}
  p.desc { text-align:center; color:#555; margin-bottom:40px; font-size:1.05rem; }
  form { display:flex; flex-direction:column; gap:15px; }
  input, select, textarea, button { padding:16px; border-radius:30px; border:1px solid #ccc; font-size:1rem; transition:all 0.3s ease; }
  input:focus, select:focus, textarea:focus { outline:none; border-color:#d4af37; box-shadow:0 4px 20px rgba(212,175,55,0.3); }
  button { background:linear-gradient(90deg,#b22222,#d40000); color:#fff; border:none; font-weight:600; cursor:pointer; transition: transform 0.3s, box-shadow 0.3s, background 0.3s; }
  button:hover { background:linear-gradient(90deg,#d4af37,#ffd700); transform:translateY(-3px) scale(1.05); box-shadow:0 8px 25px rgba(212,175,55,0.5);}
  #apercuBon { border:2px solid #d4af37; padding:40px; border-radius:25px; margin-top:30px; background:linear-gradient(135deg, rgba(212,175,55,0.1), rgba(178,34,34,0.05)); display:none; text-align:center; box-shadow:0 10px 40px rgba(212,175,55,0.2); transition:all 0.5s ease;}
  #apercuBon h3 { color:#b22222; font-family:'Playfair Display', serif; font-size:2rem; margin-bottom:15px;}
  #apercuBon p { font-size:1.1rem; line-height:1.5; color:#333;}
  .note { margin-top:15px; font-size:0.95rem; color:#555; }
  .confirmation { display:none; margin-top:20px; padding:20px; border-radius:20px; background:#e6ffed; color:#064; font-weight:600; text-align:center;}
  #bonCadeauPDF { display:none; }
</style>
</head>
<body>

<main>
<h1>Offrez un Bon Cadeau Unique</h1>
<h2>Valable au Vaudrée 2 Brasserie-Restaurant et au Beer Shop’E by Vaudrée 2</h2>
<p class="desc">Le bon cadeau n’a pas de date d’expiration et fera le bonheur de vos proches avec élégance et gourmandise !</p>

<form id="bonCadeauForm" method="POST">
  <input type="text" name="nom" placeholder="Votre nom" required>
  <input type="email" name="email" placeholder="Votre email" required>
  <input type="email" name="destinataire" placeholder="Email du destinataire" required>
  <input type="number" name="montant" placeholder="Montant du bon (€)" min="10" required>
  <select name="type" required>
    <option value="">Sélectionner type</option>
    <option value="Restaurant">Restaurant</option>
    <option value="Beer Shop">Beer Shop’E</option>
    <option value="Les deux">Les deux</option>
  </select>
  <textarea name="message" placeholder="Message personnalisé (optionnel)" rows="3"></textarea>
  <button type="button" id="btnApercu">Voir l’aperçu</button>
  <button type="submit" id="btnCommander" style="display:none;">Commander le Bon Cadeau</button>
</form>

<div id="apercuBon">
  <h3>Votre Bon Cadeau</h3>
  <p id="texteApercu"></p>
  <button id="btnTelecharger">Télécharger / Imprimer le bon</button>
  <p class="note">Après votre commande, vous recevrez toutes les informations nécessaires pour effectuer le virement et obtenir votre bon cadeau final.</p>
</div>

<div class="confirmation" id="confirmationMessage">
Merci ! Votre commande a été reçue. Vérifiez votre email pour les instructions de paiement.
</div>

</main>

<!-- Librairie jsPDF pour créer le PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;

const form = document.getElementById('bonCadeauForm');
const btnApercu = document.getElementById('btnApercu');
const btnCommander = document.getElementById('btnCommander');
const apercuBon = document.getElementById('apercuBon');
const texteApercu = document.getElementById('texteApercu');
const confirmation = document.getElementById('confirmationMessage');
const btnTelecharger = document.getElementById('btnTelecharger');

// Affichage de l'aperçu
btnApercu.addEventListener('click', () => {
  const nom = form.nom.value.trim();
  const email = form.email.value.trim();
  const destinataire = form.destinataire.value.trim();
  const montant = form.montant.value.trim();
  const type = form.type.value;
  const message = form.message.value.trim();

  if(!nom || !email || !destinataire || !montant || !type){
    alert("Merci de remplir tous les champs obligatoires.");
    return;
  }

  texteApercu.innerHTML = `
    Bonjour ${nom},<br>
    Vous êtes sur le point d’offrir un bon cadeau de <strong>${montant}€</strong> 
    valable au <strong>${type}</strong>.<br>
    ${message ? `Message personnel : "${message}"<br>` : ""}
    Ce bon sera envoyé à <strong>${destinataire}</strong> après confirmation de votre paiement.
  `;

  apercuBon.style.display = 'block';
  btnCommander.style.display = 'block';
  apercuBon.scrollIntoView({behavior:'smooth'});
});

// Génération PDF
btnTelecharger.addEventListener('click', () => {
  const doc = new jsPDF();
  doc.setFont("helvetica", "bold");
  doc.setFontSize(22);
  doc.text("Bon Cadeau Le Vaudrée 2", 20, 30);
  doc.setFontSize(16);
  doc.text(texteApercu.innerText, 20, 50);
  doc.save("Bon_Cadeau.pdf");
});

// Envoi email via Formspree
form.addEventListener('submit', function(e){
  e.preventDefault();
  const formData = new FormData(form);

  fetch("https://formspree.io/f/xnngbpgd", {
    method: 'POST',
    body: formData,
    headers: { 'Accept': 'application/json' }
  }).then(response => {
    if(response.ok){
      form.style.display='none';
      apercuBon.style.display='none';
      confirmation.style.display='block';
    } else { alert("Une erreur est survenue, veuillez réessayer."); }
  }).catch(()=>{ alert("Une erreur est survenue, veuillez réessayer."); });
});
</script>
</body>
</html>
